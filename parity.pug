section#sec-parity-mw
    title Mordell-Weil groups

    introduction
        p.
            These are notes for Céline Maistret's course MA842 at BU Spring 2019.

        p.
            The course webpage is #[url(href="https://sites.google.com/view/cmaistret/teaching#h.p_BYGoPzU848FJ")/].
        p.
            Course overview:
        p
            | Main references that we will be following:
            ol
                li Vladimir Dokchitser - Notes?
                li Silverman - Arithmetic of Elliptic Curves
                li Milne - Abelian Varieties?



    subsection#subsec-mordell-weil
        title Mordell-Weil
        aside: p Lecture 4 5/2/2018

        remark
            p
                | A homomorphism #[m \phi \colon \absgal{K} \to G] for a finite group #[m G] is continuous if it comes from a finite Galois extension, i.e.
                me \exists F/K \text{ finite Galois },\,\tilde \phi \colon \Gal{F}{K} \to G
                | s.t. #[m \phi] is  the composition #[m \absgal{K} \to  \Gal FK \xrightarrow{\tilde \phi} G]. So #[m \phi(g) ] only cares about what #[m g] does to #[m F].

        proposition
            statement: p
                | Let #[m E/K] be an elliptic curve
                me y^2 = (x-\alpha)(x-\beta)(x-\gamma)
                | for #[m P \in E(K)] have #[m \frac 12 P \in E(\overline K)] s.t. #[m \frac 12 P \oplus \frac 12 P = P].
                ol
                    li
                        | #[m K(\frac 12 P) /K] is a Galois extension and #[m \Gal{K(\frac 12 P)}{K} = C_2 \times C_2] from Lemma 1.
                        // TODO
                    li
                        me \phi_P \colon \absgal{K} \to E(K)[2]
                        me g \mapsto Q^\sigma - Q  = g(\frac 12 P) - \frac 12 P
                        | is well defined and has kernel #[m \Gal{K}{K(\frac 12 P)}].
                    li
                        me \phi \colon E(K) / 2E(K) \to \Hom_{cts}(\absgal{K}, E(K)[2])
                        me P \mapsto \phi_P
                        | is well defined and injective.
                        | Now #[m \phi_P] is continuous by #[m 2.] and  so
                        me \phi_{P\oplus Q} (g) = g(\frac 12 (P\oplus Q)) - (\frac 12 P\oplus \frac 12 Q)
                        me = g(\frac 12 P) \oplus g(\frac 12Q) - \frac 12 P \ominus \frac 12 Q
                        me = \phi_P(g) \oplus \phi_Q(g)
                        | a homomorphism.
                        me \phi_{2Q}(g) = g(\frac 12 2 Q)) - \frac12 2(Q) = g(Q) - Q = 0
                        | for all #[m g\in \absgal K] if #[m Q \in E(K)] so  this is well defined.
                        | For injectivity:
                        me \phi_P(g) = 0 \implies g(\frac 12 P) = \frac 12 P \forall g \in \absgal K
                        me \implies \frac 12 P \in E(K) \implies P \in 2 E(K)
                        | which gives injectivity.
                    li
                        me \eta \colon \Hom_{cts}(\absgal K , E(K) [2] ) \to K^\times/{K^\times}^2 \times K^\times/{K^\times}^2 \times K^\times/{K^\times}^2
                        me \psi \mapsto\psi_\alpha ,\psi_\beta, \psi_\gamma
                        me \psi(g )\in \{0, (\alpha,0)\} \subseteq E(K) \iff g \in \Gal{\overline K }{K(\sqrt {\psi_\alpha})}
                        | then #[m \eta] is an injective homomorphism.
                        | It is an isomorphism to the subgroup of triples #[m a,b,c] s.t. #[m abc \in {K^\times}^2].
                        | Proof:
                        me \Hom_{cts}(\absgal K, C_2) \simeq K^\times/{K^\times}^2
                        | with #[m \psi] s.t. #[m \ker \psi = \Gal{\overline K}{ K\sqrt d}  \leftrightarrow d].
                        | It is an isomorphism:
                        me \ker \psi_i = \Gal{\overline K}{ K(\sqrt {d_i})},\,i =1,2
                        me \ker \psi_1 \psi_2 = \Gal{\overline K}{ K(\sqrt {d_1d_2})}
                        | Now apply this to #[m E(K) \lb 2\rb = C_2 \times C_2] to get an isomorphism to #[m K^\times / {K^\times}^2 \times K^\times / {K^\times}^2 ].
                        | Record this third homomorphism to get #[m \eta].
                    li
                        | If #[m P = (x_0, y_0) \in E(K)] then
                        me \eta(\phi_P)   = (x_0 - \alpha, x_0 - \beta, x_0 -\gamma)
                        | .
                        | Proof sketch:
                        | If
                        me E\colon y^2 = x^3 + Ax^2 + Bx
                        | then for #[m Q = (x_0, y_0) \in E(K)].
                        me 2Q = \left(\left( \frac {x_0 - B}{2y_0}\right)^2 , \ldots\right)
                        | Hence if #[m 2Q = P  = (x_1, y_1)] then  #[m \sqrt{x_1} \in K(\frac 12 P)].
                        | So if
                        me E \colon y^2 = (x-\alpha)(x-\beta)(x-\gamma)
                        | then
                        me P = (x_2, y_2)
                        | then
                        me \sqrt{x_2 - \alpha} , \sqrt{x_2 - \beta} , \sqrt{x_2 - \gamma} \in K(\frac  12 P)
                        me K(\sqrt{x_2 - \alpha}) , K(\sqrt{x_2 - \beta}) , K(\sqrt{x_2 - \gamma}) \subseteq K(\frac  12 P)
                        me \implies K(\frac 12 P)  = K(\sqrt{x_2 - \alpha},\sqrt{x_2 - \beta} , \sqrt{x_2 - \gamma})

        example
            statement
                p
                    | Let
                    me E \colon y^2 = x(x-1)(x+1)
                    | for #[m P \in E(\QQ), \QQ(\frac 12 P ) / \QQ] can only ramify at 2.
                    me \QQ(\frac 12 P ) \subseteq \QQ(i, \sqrt2)
                    me P = (x_0, y_0) \mapsto x_0, x_0 - 1, x_0 + 1 \in \QQ^\times/ {\QQ^\times}^2
                    | is a  homomorphism so #[m x_0 , x_0  -1 , x_0 + 1 ] are #[m \pm 1, \pm 2] up to square.


                table
                    caption Images
                    tabular(top="major",left="major",right="major",bottom="major")
                        | #[col(right="minor")/] #[col(right="minor")/] #[col(right="minor")/] #[col/]
                        row(bottom="minor") #[cell: m x_0] #[cell: m x_0 - 1] #[cell: m x_0 + 1] #[cell rat?]
                        row #[cell 1] #[cell 1] #[cell 1] #[cell 1) rat]
                        row #[cell 1] #[cell -1] #[cell -1] #[cell 2) non-rat]
                        row #[cell 1] #[cell 2] #[cell 2] #[cell 1) rat]
                        row #[cell 1] #[cell -2] #[cell -2] #[cell 2) non-rat]
                        row #[cell -1] #[cell 1] #[cell -1] #[cell 2) non-rat]
                        row #[cell -1] #[cell -1] #[cell 1] #[cell 1) rat]
                        row #[cell -1] #[cell 2] #[cell -1] #[cell 2) non-rat]
                        row #[cell -1] #[cell -2] #[cell 2] #[cell 1) rat]
                        row #[cell 2] #[cell 1] #[cell 2] #[cell 3) non-rat]
                        row #[cell 2] #[cell -1] #[cell -2] #[cell 2) non-rat]
                        row #[cell 2] #[cell 2] #[cell 1] #[cell 4) rat]
                        row #[cell 2] #[cell -2] #[cell -1] #[cell 2) non-rat]
                        row #[cell -2] #[cell 1] #[cell -2] #[cell ?]
                        row #[cell -2] #[cell -1] #[cell 2] #[cell ?]
                        row #[cell -2] #[cell 2] #[cell -1] #[cell ?]
                        row #[cell -2] #[cell -2] #[cell 1] #[cell ?]
                p
                    | 1) The 2-torsion points #[m P = 0 ,(0,0), (1,0), (-1,0) \in E(\QQ)] give us some rows.
                    | 2) As we have #[m x_0 \gt -1] we get #[m x_0 + 1 \gt 0] so #[m x_0(x_0 - 1) \gt 0] for the product to be a square (and hence #[m \gt 0]).
                    | 3) #[m x_0 = 2A^2], #[m x_0-1 = B^2], #[m x_0 + 1 = 2C^2] with #[m A,B,C \in \QQ \smallsetminus \{ 0\}].
                    | Let #[m A = m/n] so #[m 2m^2/ n^2 - 1 = B^2]
                    me 2m^2 - n^2 = (Bn)^2
                    |and
                    me 2m^2+ n^2 = 2(Cn)^2
                    | if #[m m \equiv 0(2) \implies -1 = \square \pmod 8] a contradiction.
                    me m \equiv 1 \pmod2 \implies m^2 \equiv1 \pmod 8
                    |.
                    | So #[m 2 - n^2 = \square \pmod 8 \implies n^2 \equiv1 \pmod 8]
                    me 2 + n^2 = 2\square \pmod 8 \implies n^2 \equiv 0 \pmod 8
                    me |E(\QQ) / 2 E(\QQ)| = 4
                    me | E(\QQ)[2]| = 4 \implies \rk = 0
                    me E(\QQ) \cong  E(\QQ) [2 ]
                    | .
                    | 4) Use the group structure!

        theorem
            title Complete 2-decent
            statement: p
                | Let #[m K] be a field of characteristic 0 and
                me E \colon y^2 = (x-\alpha)(x-\beta)(x-\gamma),\,\alpha,\beta,\gamma \text{ distinct}
                |. The map
                me P \mapsto (x_0 - \alpha, x_0 - \beta, x_0 - \gamma)
                | replacing #[m x_0 -\alpha] with  #[m (x_0 - \beta) (x_0 - \gamma)] if 0.
                me E(K) / 2E(K) \to (K^\times/ {K^\times}^2) ^3
                | Triples #[m (a,b,c)] that lie in the image satisfy #[m abc \in {K^\times}^2].
                | A triple #[m a,b,c] with #[m abc \in {K^\times}^2] lies in the image iff
                | it is in the image of #[m E(K)\lb 2\rb] or
                me cz_3^2 - \alpha + \gamma = az_1^2
                me cz_3^2 - \beta + \gamma = bz_1^2
                | is soluble with #[m z_i \in K^\times].
                | In which case
                me P = (az_1^2 + \alpha, \sqrt{abc}, z_1z_2z_3) \mapsto (a,b,c)
                | iii) If #[m K] is a number field and #[m (a,b,c)] is in the image then
                me K(\sqrt{a}, \sqrt{b}, \sqrt{c}) / K
                | only ramifies at primes dividing #[m 2(\alpha - \beta)(\alpha - \gamma)(\beta - \gamma)].
        exercise
            statement: p
                me E \colon y^2 = x(x-5)(x+5)
                | .

        aside: p Lecture 5 7/2/2018

        p
            | Recall:
            me \phi \colon E(K)/2E(K) \to \Hom_{cts}(G_K, E(K) [2])
            me P \mapsto \phi_P
            | where #[m \phi_P \colon \sigma \mapsto Q^\sigma - Q] where #[m Q = 2P].
            | Which is well-defined and injective.
        p
            | Elements of
            me \Hom_{cts}(G_K, E[2]) \leftrightarrow a,b,c \in (K^\times / {K^\times}^2) \text{ s.t. } abc \in {K^\times}^2
            me (x_0,y_0) \mapsto (x_0 - \alpha, x_0 - \beta, x_0  -\gamma)
            | .
        lemma
            statement: p
                | Let #[m n \ge 1]
                ol
                    li
                        me \psi \colon E(K)/ nE(K) \to \{ K \subseteq F \subseteq \overline K\}
                        me P\mapsto K(\frac 1n P, E[n])

                        | is well defined.
                    li
                        | #[m K(\frac 1n P, E\lb n \rb ) / K] only ramifies at #[m \ideal p | n \Delta_E].
                    li
                        me \Gal{K(\frac 1n P, E [n] )}{K} \le \ZZ/n \times \ZZ/n
                    li
                        | There are only finitely many fields satisfying 2. and 3. so #[m \image \psi] is finite.

        p
            | To do descent, need more than #[m \psi] (i.e. injection).

        definition
            statement: p
                | Let #[m G] be a group and  #[m M] a #[m G]-module then let
                me H^0(G, M) = M^G = \{m \in M : gm = m \forall g\in G\}
                me H^1(G, M) = \{\text{skew homs } G \to M\}/\{\text{skew homs } G \to M \text{ of the form }g\mapsto g(t) - t,\, t\in M\}
                | .

        remark
            p
                | If #[m G] acts trivially on #[m M] then
                me H^0(G, M) = M
                me H^1(G, M) = \Hom(G,M)
                | .
            p
                | When #[m G] is profinite then we want that the skew homomorphisms factor through finite Galois  groups.
                | We will prove that
                me E(K)/nE(K) \hookrightarrow H^1(G_K, E[n])
                | .

        theorem
            statement: p
                | If
                me 0 \to A \to B \to C \to 0
                | is an exact sequence of #[m G]-modules then
                me 0 \to H^0(G,A)\to H^0(G,B)\to H^0(G,C)\to H^1(G,A)\to H^1(G,B)\to H^1(G,C)
                | .

        lemma
            statement: p
                ol
                    li
                        | #[m \psi] is finite-to-one (gives Mordell-Weil)
                    li
                        | Let
                        me \phi_P \colon G_K \to E[n]
                        me \phi_P (gh) = \phi_P(g) + g \phi_P(h)
                        | is a skew (or crossed) homomorphism.
                        | If #[m (\frac 1n P ) '] is another choice of #[m \frac 1n P] and #[m \phi_P'] is the corresponding skew homomorphism, then
                        me \phi_P - \phi_P '
                        | is of the form
                        me g\mapsto T \ominus gT
                        | where #[m T \in  E\lb n\rb].
                    li
                        | #[m \phi_P] factors through
                        me \Gal{K(\frac 1n P, E\lb n \rb)}{K}
                        |.
                    li
                        me \phi\colon E(K) / nE(K) \to Z/B
                        me P \mapsto \phi_P
                        | is an injective homomorphism.
                        | Where
                        me Z = \{\text{skew homs } G_K \to E[n]\}
                        me B = \{\text{skew homs } G_K \to E[n] \text{ of the form }g\mapsto T\ominus gT,\,T\in E\lb n\rb\}
                        |.
        proof
            p
                ol
                    li
                        | There are finitely many skew homomorphisms
                        me \Gal{K(\frac 1nP, E[n])}{K} \to E[n]
                        | and by 4.
                        me P \mapsto \{\phi_P, K(\frac 1n P, E\lb n \rb)\}
                        | is injective.
                        | So #[m \psi\colon P\mapsto K(\frac 1n P, E\lb n \rb)] is finite to one by 3.
                    li
                        me \phi_P(gh) = \frac 1n P \ominus gh \frac 1n P
                        me = \left((\frac 1n P) \ominus g(\frac 1n P)\right) \oplus \left( g(\frac 1n P) \ominus g(h(\frac 1n P))\right)
                        me = \phi_P \oplus g(\phi_P(h))
                        | .
                        | Remark: If #[m E\lb n \rb \subseteq E(K)] then #[m \phi_P] is a homomorphism.
                        | Recall for #[m n=2]
                        me \phi_P(gh) = \frac 12 P \ominus gh(\frac 12 P)
                        me  = \frac12 P \ominus h(\frac 12P) \oplus h(\frac 12 P) \ominus g(h( \frac 12 P))
                        me = \phi_P(h) \oplus \phi_P(g)
                        | since #[m 2h(\frac 12 P) = h(P)= P].
                        | Consider now
                        me \frac 1n P = \frac 1n P'  \oplus T
                        | for some #[m T\in E\lb n \rb]
                        me (\phi_P \ominus \phi_{P}')(g) = \phi_P(g)  - \phi_{P}'(g) =  \frac 1n P \ominus g(\frac 1n P) - [(\frac 1n P ) \oplus T \ominus g(\frac 1n P) \oplus gT]
                        me =T \ominus gT
                        | .

        p
            | Take #[m G= G_K]
            me B = E(\overline K), A= E[n], C = E(\overline K)
            | to get
            me 0 \to E[n] \to E(\overline K) \xrightarrow{\cdot n} E(\overline K) \to 0
            | which gives the long exact sequence
            me 0 \to E(K)[n] \to E(K) \xrightarrow{\cdot n} E(K) \xrightarrow{\delta} H^1(G_K, E[n]) \to H^1(G_K, E(\overline K)) \to
            me \implies E(K)/nE(K) \hookrightarrow H^1(G_K, E[n])
            | .
        p
            | Problem:
            me H^1(G_K, E[n])
            | is infinite.
            | What subgroup of
            me H^1(G_K, E[n])
            | do we land in?


        p
            | Notation:
            | When #[m v] is a place of #[m K] we have #[m G_{K_v} \subseteq G_K], for any module #[m M] have #[m M^{G_K} \le M^{G_{K_v}}] and
            me \Res \colon H^1(G_K, E[n]) \to H^1 (G_{K_v} , E[n])
            | .
        p
            | We have from the theorem
            me.
                \xymatrix{
                0 \ar[r] &amp; E(K)/ nE(K)\ar[d] \ar[r]^\delta &amp; H^1(G_K, E[n]) \ar[d]^{\Res} \ar[r] &amp; H^1(G_K, E(\overline K))[m] \ar[d]^{\Res}\ar[r]&amp;0\\
                0 \ar[r] &amp; \prod_v E(K_v)/ nE(K_v) \ar[r]^\delta &amp; \prod_v H^1(G_{K_v}, E[n]) \ar[r] &amp; \prod_v H^1(G_{K_v}, E(\overline K))[m] \ar[r]&amp;0
                }
            | we want to understand #[m \image \delta] i.e. the subgroup
            me \ker \{ H^1(G_K, E[n]) \to H^1 (G_K, E(\overline K))\}
            | this is as hard as finding #[m E(K)], here is why:
        claim
            statement: p
                me H^1(G_K, E(\overline K))
                | corresponding to principal homogeneous spaces for #[m E] (genus 1 curves whose jacobian is #[m E])
        p
            | Finding
            me \ker \{ H^1(G_K, E[n]) \to H^1 (G_K, E(\overline K))\}
            | is equivalent to finding which PHS coming from #[m H^1] have a rational point.
            | ??? Hensel's lemma.

        p
            | Let #[m C] be a curve
            me \operatorname{Isom}(C) \leftrightarrow C(\overline K) \times \Aut(C)
            me \tau_p \circ \alpha \leftrightarrow (P,\sigma)
            me \operatorname{Twist}(E/K) \leftrightarrow H^1(G_K, \operatorname{Isom}(C))
            me C\simeq_{\overline K} E
            me PHS \leftrightarrow H^1(G_K, E(\overline K))
            | #[m C] is a PHS for #[m E] iff #[m E] is the jacobian of #[m C].

        aside: p Lecture 6 14/2/2018
        p
            me.
                \xymatrix{
                0 \ar[r] &amp; E(K)/ nE(K)\ar[d] \ar[r]^\delta &amp; H^1(G_K, E[n]) \ar[d]^{\Res} \ar[r] &amp; H^1(G_K, E(\overline K))[m] \ar[d]^{\Res}\ar[r]&amp;0\\
                0 \ar[r] &amp; \prod_v E(K_v)/ nE(K_v) \ar[r]^\delta &amp; \prod_v H^1(G_{K_v}, E[n]) \ar[r] &amp; \prod_v H^1(G_{K_v}, E(\overline K))[m] \ar[r]&amp;0
                }
        definition#def-twist-curve
            title Twists of curves
            statement: p
                | A #[term twist] of #[m C/K] is a smooth curve #[m C'/K] that is isomorphic to #[m C] over #[m \overline K].

        p
            | If #[m C_1, C_2] are twists of #[m C/K] and #[m C_1\simeq_K C_2] then we say that #[m C_1] and #[m C_2] are equivalent modulo #[m K]-isomorphism.

        p
            | We denote #[m \operatorname{Twist}(C/K)] - the set of twists of #[m C/K] modulo #[m K]-isomorphism.
        theorem
            statement: p
                | The twists of #[m C/K] up to #[m K]-isomorphism are in 1-1 correspondence with elements of
                me H^1(G_K, \operatorname{Isom}(C))
                | where
                me \operatorname{Isom}(C) = \{\overline K\text{-isomorphisms } C\to C\}
                | .
            proof
                p
                    | Let #[m C'/K] be a twist of #[m C/K] then there exists an isomorphism #[m /\overline K]
                    me \phi\colon C' \to C
                    | associate the following map
                    me \xi \colon G_K \to \operatorname{Isom}(C)
                    me \sigma\mapsto \phi^\sigma \phi\inv
                    | .
                p
                    | Check that #[m \xi] is a cocycle
                    me \xi_{\sigma\tau } = (\xi_{\sigma})^\tau \xi_\tau
                    | for all #[m \sigma,\tau\in G_K].
                    | Denote #[m \{\xi\}] the associated class in #[m H^1].
                    | #[m \{\xi\}] is determined by the #[m K]-isomorphism class of #[m C'] independent of the choice #[m \phi].
                p
                    | The map
                    me \operatorname{Twist}(C/K) \leftrightarrow H^1(G_K, \operatorname{Isom}(C))
                    me C' \mapsto \{\xi\}
                    | is a bijection.
                p
                    | Injective, trace through.
                p
                    | Surjectivity, define the function field using the curve.
        remark: p
            | If #[m C] is an elliptic curve then #[m \operatorname{Isom}(C)] is generated by
            me \Aut(C) (\text{fixing }0)
            | and translations
            me \tau_P \colon C \to C
            me Q\mapsto Q+P
            |.

        example
            statement: p
                | #[m E/K] elliptic, consider
                me K(\sqrt d)
                | a quadratic extension and #[m \chi] the associated character
                me \chi\colon G_K \to \{\pm 1\}
                me \sigma \mapsto \sigma(\sqrt d) / \sqrt d
                | .
                | The group #[m \pm 1] can be viewed as automorphisms of #[m C].
                | So use #[m \chi] to define the cocycle
                me \xi \colon G_K \to \operatorname{Isom}(C)
                me \sigma \mapsto [\chi (\sigma)]
                | .
                | Let  #[m C/K] be the corresponding twist of #[m E/K], we find an equation for #[m C/K].
                | Choose
                me y^2 = f(x) \text{ for } E/K
                | and write
                me \overline K(E) = \overline K(x,y)
                me \overline K(C) = \overline K(x,y)_\xi
                | since #[m \lb - 1 \rb(x,y) = (x,-y)] the action of #[m \sigma \in G_K] on
                me \overline K(x,y)_\xi \text{ is given by }\sqrt d ^\sigma = \chi(\sigma) \sqrt d
                me x ^\sigma = x,\,y = \chi(\sigma) y
                | note that the function #[m x' = x] and #[m y' = y /\sqrt d] are in #[m \overline K(x,y)_\xi] and are fixed by #[m G_K].
                | Now #[m x',y'] satisfy
                me d{y'}^2  =f(x')/K
                | is defined over #[m K] and defines an elliptic curve.
                | Moreover
                me (x,y) \mapsto (x', y' \sqrt{d})
                | is an isomorphism over #[m K(\sqrt d)].


        p
            | Note #[m C/K] is not a principal homogeneous space for #[m E/K].

        definition#def-homog-space
            title Homogenous spaces
            statement: p
                | Let #[m E/K] be an elliptic curve, a principal homogeneous space for #[m E/K] is a smooth curve #[m C/K] together with a simply transitive algebraic group action of #[m E] on #[m C] defined over #[m K].
                me \mu \colon C\times E \to C
                | morphism defined over #[m K] satisfying
                ol
                    li
                        me \mu(P, 0) = P \,\forall P \in C
                    li
                        me \mu(\mu(p,P), Q) = \mu(p,P+Q) \,\forall P \in C
                    li
                        me \forall p,q \in C,\,\exists ! P\in E \text{ s.t. }
                        me \mu(p,P) = q
                        | so we may define a subtraction map
                        me \nu \colon C\times C \to E
                        me p,q \mapsto P
                        | as above.

        proposition
            statement: p
                | Let #[m E/K] and #[m C/K] be a principal homogeneous space for #[m E/K].
                | Fix a point #[m p_0 \in C] and define a map
                me \theta \colon E \to C
                me P \mapsto \underbrace{p_0 + P}_{\mu(p_0, P)}
                | .
                ol
                    li
                        | #[m \theta] is an isomorphism over #[m K(p_0)].
                        | In particular  #[m C/K] is a twist of #[m E/K].
                    li
                        | #[m \forall p,q \in C]
                        me q- p = \theta\inv(q) - \theta \inv (p)
                        | .
                    li
                        | #[m \theta] is a morphism over #[m K].

        definition
            statement: p
                | Two homogeneous space #[m C/K] and #[m C'/K] for #[m E/K] are equivalent if there is an isomorphism
                me \phi \colon C \to C'
                | defined over #[m K] and is compatible with the action of #[m E] on #[m C] and #[m C'].
                me.
                    \xymatrix{
                    C \ar[r]^\theta \ar[d]_\phi &amp; E \ar[d] \\
                    C' \ar[r] &amp; E'
                    }

        p
            | The equivalence class of PHS for #[m E/K] containing #[m E/K] acting on itself via translation is called the trivial class.

        p
            | The collection of equivalence classes of PHS for #[m E/K] is called the Weil-Châtelet group, denoted
            me WC(E/K)
            | .

        proposition
            statement: p
                | Let #[m C/K] be a PHS for #[m E/K] then #[m C/K] is in the trivial class #[m \iff  C(K) \ne \emptyset].

        theorem
            statement: p
                | Let #[m E/K] then there is a natural bijection after fixing #[m p_0 \in C]
                me WC(E/K) \to H^1 ( G_K, \underbrace{E(\overline K)}_{\subseteq \operatorname{Isom}(E)})
                me \{C/K\} \mapsto \{ \sigma \mapsto p_0^\sigma -  p_0\}

            proof
                p
                    | Well-definedness:
                    me \sigma \mapsto p_0^\sigma - p_0
                    | is a cocycle.
                    | Suppose that #[m C'/K] and #[m C/K] are two equivalent PHS then
                    me p_0^\sigma - p_0
                    | and
                    me {p_0'}^\sigma - p_0'
                    | are cohomologous.
                p
                    |Injective, suppose that #[m p_0^\sigma - p_0] and #[m {p_0'} ^\sigma - p_0'] corresponding to #[m C/K] and #[m C'/K] that are cohomologous and prove that #[m C\simeq_K C'].
                p
                    | Surjective: let #[m \xi \colon G_K \to E(\overline K)] be a cocycle representing an element in #[m H^1(G_K, E)].
                    | Embed
                    me E(\overline K) \hookrightarrow \operatorname{Isom}(E)
                    me P \mapsto \tau_P
                    | and view
                    me \xi \in H^1(G_K, \operatorname{Isom} E)
                    |.
                p
                    | From the theorem on
                    me \operatorname{Twist}(E/K) \leftrightarrow H^1(G_K, \operatorname{Isom}(E))
                    | there exists a curve #[m C/K] and a #[m \overline K]-isomorphism
                    me \phi\colon C \to E
                    | s.t.
                    me \forall \sigma \in G_K : \phi^\sigma \phi\inv = \text{translation by } -\xi_\sigma
                    | .
                    | Define a map #[m \mu \colon C\times E \to C]
                    me (p,Q) \mapsto \phi\inv (\phi(p) + Q)
                    | .
                p
                    | Show that #[m \mu] is simply transitive.
                p
                    | Show #[m \mu] defined over #[m K].
                    | Compute the cohomology class associated to #[m C/K] and show it is #[m \xi].

        remark: p
            | For a given #[m C/K] of genus 1 one can define several structures of PHS.
            me \{C/K,\mu\}^\alpha = \{ C/K , \mu\circ(1\times \alpha)\}
            me \mu^\alpha(p,Q) = \mu(p, \alpha Q)
            | for #[m \alpha \in \Aut(E)].
            me.
                \xymatrix{
                C \ar[r]^\mu &amp; E \ar[d]_P \\
                C' \ar[r]^{\mu^\alpha} &amp; E'
                }

        aside: p Lecture 7 21/2/2018

        example
            statement: p
                | #[m E/K] and #[m K (\sqrt d)/K] a quadratic extension.
                | Let #[m T \in E(K)] be a non-trivial point of order 2.
                | Then #[m \xi\colon G_K \to E]
                me.
                    \sigma \mapsto
                    \begin{cases}
                    0 \amp\text{ if } (\sqrt d)^\sigma = \sqrt d,\\
                    T \amp\text{ if } (\sqrt d)^\sigma = -\sqrt d.
                    \end{cases}
                |.
                | We construct the PHS corresponding to #[m \{\xi \} \in H^1(G_K, E(\overline K))].
                | Since #[m T \in E(K)] can choose a Weierstraß equation for #[m E/K]
                me E\colon y^2 = x^3 + ax^2 + bx \text{ with } T = (0,0)
                | then the translation by #[m T] map is given by
                me \tau_T(P) = (x,y) + (0,0) = \left(\frac bx, -\frac{by}{x^2}\right)
                | for
                me P = (x,y)
                | .
                | Thus if #[m \sigma \in G_K] is non-trivial, #[m \sigma] acts on #[m \overline K(E)_\xi], which is isomorphic to #[m \overline K(E)] but #[m \absgal K] action is twisted by #[m \xi], i.e. #[m x^\id \mapsto (x^\id)^\sigma].
                me (\sqrt d )^\sigma = -\sqrt d
                me x^\sigma = \frac bx ,\, y^\sigma = -\frac{by}{x^2}
                | need to find the subfield of  #[m K(\sqrt d)(x,y)_\xi] fixed by #[m \sigma].
                | Note:
                me \frac{\sqrt d x}{y},\,\sqrt d \left(x  -\frac bx\right)
                | are invariant, take
                me z = \frac{\sqrt d x }{y},\,w = \sqrt d\left( x - \frac bx\right)\left(\frac xy\right)^2
                | and find relations between #[m z] and #[m w] to get
                me C \colon dw^2 = d^2 - 2a dz^2 + (a^2 - 4b) z^4
                | .
                | Claim: #[m C/K] is the PHS of #[m E/K] corresponding to #[m \left\{\xi\right\}].
                | There is a natural map
                me \phi \colon E \to C
                me (x,y) \mapsto (z,w)
                me (x,y) \mapsto \left( \frac{ \sqrt d y}{x^2 + ax + b}, \frac{\sqrt d (x^2 - b)}{x^2 + ax + b}\right)
                | so that
                me \phi (0,0) = (0,-\sqrt d)
                me \phi (0) = (0,\sqrt d)
                ul
                    li
                        | Prove that #[m \phi ] is an isomorphism so #[m C] is a twist.
                    li
                        | #[m C] is the PHS corresponding to #[m \{\xi\}].
                        | Take #[m p \in C ] and compute
                        me \sigma\mapsto p^\sigma - p = \phi\inv(p^\sigma) - \phi\inv (p)
                        | for example let #[m p = (0,\sqrt d) \in C], if #[m \sigma = \id] then #[m p^\sigma - p = 0 - 0 = 0].
                        | If #[m \sigma = -\id] then #[m p^\sigma - p = T - 0 = T].


        p
            | Back to Selmer, we want to have the image of our weak Mordell-Weil land in something finite.
            me.
                \xymatrix{
                0 \ar[r] &amp; E(K)/ mE(K)\ar[d] \ar[r]^\delta &amp; H^1(G_K, E[m]) \ar[d]^{\Res} \ar[r] &amp; WC(E/K)[m] \ar[d]^{\Res}\ar[r]&amp;0 \\
                0 \ar[r] &amp; \prod_v E(K_v)/ nE(K_v) \ar[r]^\delta &amp; \prod_v H^1(G_{K_v}, E[n]) \ar[r] &amp; \prod_v WC (E/ K_v)[m]               \ar[r]&amp;0
                }

        definition#def-m-selmer
            title #[m m]-Selmer groups
            statement: p
                | The #[m m]-Selmer group of #[m E/K] is the subgroup of
                me H^1(G_K, E[m])
                | defined by
                me \Sel^m(E/K) = \ker \left\{H^1(G_K, E[m]) \to \prod_v WC(E/K_v) \right\}
                | .

        definition#def-sha
            title The Shafarevich-Tate group
            statement: p
                | The #[term Shafarevich-Tate] group of #[m E/K] is the subgroup of
                me WC(E/K)
                | defined by
                me \Sha(E/K) = \ker\left\{WC(E/K) \to\prod_v WC(E/K_v)\right\}
                | .

        theorem
            statement: p
                | There is an exact sequence
                ol
                    li
                        me 0 \to E(K)/mE(K) \to \Sel^m(E/K)  \to \Sha(E/K)[m] \to 0
                    li
                        | #[m \Sel^m(E/K)] is finite.

    subsection#subsec-p-inf-selmer
        title #[m p^\infty]-Selmer and the structure of #[m \Sha]

        p
            | #[m H^1(G_K, E(\overline K))] is torsion for general galois cohomological reasons.
            | So
            me \Sha (E/K) \subseteq H^1(G_K, E(\overline K))
            | is torsion.
        p
            | So we may write
            me \Sha(E/K) = \bigoplus_p \Sha_{p^\infty}(E/K)
            | where for each prime #[m p]
            me \Sha_{p^\infty} (E/K)
            | denotes the #[m p]-primary part of #[m \Sha(E/K)].
            | (i.e. the subgroup of elements whose order is a power of #[m p].)
            | By descent
            me \Sha (E/K) [ m] \text{ is finite for all } m \ge 1
            | .
        p
            | So
            me \Sha_{p^\infty} (E/K) \cong (\QQ_p/\ZZ_p)^{\delta_p} \oplus T_p,\, \delta_p \in \ZZ_{\ge 0}
            | where #[m T_p] is a finite abelian #[m p]-group.
            me T_p \cong \ZZ/p^{s_1} \ZZ \oplus \cdots \oplus \ZZ/p^{s_l} \ZZ,\,s_i\in \ZZ_{\ge 0}
            | .
            | The group
            me \bigoplus_p (\QQ_p/\ZZ_p)^{\delta_p}\subseteq \Sha (E/K)
            | is called the infinitely divisible subgroup of #[m \Sha] denoted #[m \Sha_{div}].
        p
            | The conjecture that #[m \Sha] is finite implies #[m \delta_p = 0] for all #[m p].
            | And #[m T_p \ne 0 ] for only finitely many #[m p].
        p
            | There is a pairing called the Cassels-Tate pairing
            me \Sha(E/K) \times \Sha(E/K) \to \QQ/\ZZ
            | which is bilinear and alternating, and the kernel on either side is the infinitely divisible group.
            | If #[m \Sha(E/K)] is finite then the pairing is non-degenerate and hence
            me |\Sha(E/K)| = \square    \in \ZZ
            | .

        definition#def-p-inf-selmer
            title #[m p^\infty]-Selmer group
            statement: p
                | Consider #[m \Sel_{p^n}(E/K)] and take the direct limit
                me \varinjlim_n \Sel_{p^n}(E/K)
                | to define the #[m p^\infty]-Selmer group.

        p
            | One shows that
            me X_p(E/K) = \Hom_{\ZZ_p} (\varinjlim_n \Sel_{p^n}(E/K), \QQ_p/\ZZ_p)
            | called the Pontyragin dual of the #[m p^\infty] Selmer group is a finitely generated #[m \ZZ_p]-module.
            | The associated #[m \QQ_p]-vector space, denoted #[m \mathcal X_p(E/K) =X_p(E/K) \otimes_{\ZZ_p} \QQ_p] has dimension #[m \rk_p].

        definition#def-p-inf
            statement: p
                | #[m \rk_p] is called the #[m p^\infty]-Selmer rank of #[m E/K] and satisfies
                me \rk_p = \rk(E/K) + \delta_p
                | .
        p
            | So if #[m \Sha] is finite then #[m \delta_p =0] for all #[m p].
            | Use BSD to compute parity of #[m \rk_p].
